var/sayings = list("worldsays, ''Make sure to wear lots of sun screen because you've obviously not been out in a few years. Try and make some friends. Start with the Star-Trek nerds, then slowly move your way up to the Pokemon kids. I think you can finish life from there. ~_^''","worldsays, ''You know, there is always a chance that I could pop up, and your head could go flying...Oh wait, you don't have a head anyway. Never mind.''","worldsays, ''This game diserves a lot of gratitude, but you people are too foolish to know it.''","worldsays, ''When I jump, your computer screen will crack. *A crack is heard in the distance* Oh wait, that was my head...''","worldsays, ''All your base are belong to us.''","worldsays, ''*FART!* Excuse me. *BBBBBBBBBBUUUUUUUUUUUUUURRRRRRRRRRRRPPPPPPPPPPPPPPPPP* WOOH! Excuse me again.''","worldsays, ''Hey, I got a good joke.  I was walking in the park, and I saw two guys that looked like clones talking to each other.  One said, That's what I've been trying to tell you! *Rips off mask* I'm not me, I'm you!''","worldsays, ''Hey I bet you NEVER knew this. Googoogaagaamama, I'm a clone baby...Mmmmmm yeah.''","worldsays, ''Well lookie here, there's a nice new operating system on Ebay for $10.  It's called ''Fuck Off''.''","worldsays, ''''Fuck Off'' is such a GREAT operating system.  It's so good, they made a sequel to it.  It's called ''Windows Version Fuck Off.''  This is like 10x better than the orignal, it includes buttons!''","worldsays, ''Whoever disses Linux, should be shot.  I mean, Linux is a lot better than Windows.  Windows crashes too much.  But, since everyone in this world is a complete idiot, they don't know how to use Linux, because its such a COMPLICATED operating system.''","worldsays, ''There once was an engineer who lost a debate.''","worldsays, ''Hey, are you Bob the Headless Baphoon?  What?  It's the guy next door?  Okay.''","worldsays, ''Late one night a drunk guy is showing some friends around his brand new apartment. The last stop is the bedroom, where a big brass gong sits next to the bed.  ''What's that gong for?'' the friend asks him.  ''It's not a gong,'' the drunk replies. ''It's a talking clock.''  ''How does it work?'' asks the man.  The guys picks up a hammer, gives the gong an ear-shattering pound, and steps back.  Suddenly, someone on the otherside of the wall screams, ''For God's sake, you asshole...it's 3:30 in the god damn morning!''","worldsays. ''A woman walks into the downtown welfare office, trailed by 15 kids... ''WOW,'' the social worker exclaims, ''Are they ALL YOURS???'' ''Yep they are all mine,'' the flustered mumma sighs, having heard that question a thousand times before. She says, ''Sit down Leroy. All the children rush to find seats.  ''Well,'' says the social worker, then you must be here to sign up. I'll need all your children's names.''  ''This one's my oldest - he is Leroy.'' ''OK, and who's this one?'' Well, this one he is Leroy, also.'' The social worker raises an eyebrow but continues. One by one, through the oldest four, all boys, all named Leroy. Then she is introduced to the eldest girl, named Leighroy!  ''All right...'' says the caseworker, ''I'm seeing a pattern here. Are they ALL named Leroy?'' Their Momma replied, ''Well, yes - it makes it easier. When it is time to get them out of bed and ready for school, I just yell 'Leroy!' An' when it's time for dinner, I just yell 'Leroy!' an' they all come a runnin.' An 'if I need to stop the kid who's running into the street, I just yell 'Leroy' and all of them stop. It's the smartest idea I ever had, namin' them all Leroy.''  The social worker thinks this over for a bit, then wrinkles her forehead and says tentatively, ''But what if you just want ONE kid to come, and not the whole bunch?'' ''Ah, that's so easy,'' said the momma. ''Then I calls them by their last names.''''","worldsays, ''A husband, wife and son are barely making ends meet on their farm. One morning the woman sees the family's only cow lying dead in the field and hangs herself in desperation. When the man awakens, he sees his wife and cow dead and shoots himself. The son finds his parents dead and goes to drown himself, only to discover a mermaid at the river. The mermaid tells him, ''If you have sex with me 10 times in a row, I will revive your parents and the cow.'' ''Why not 20?'' replies the son. ''Fine,'' she says. ''Twenty it is.'' ''But wait,'' says the boy. ''How do I know that 20 times in a row won't kill you like it did the cow?''''","worldsays, ''Only in America does the pizza come faster than the ambulence...''","worldsays, ''Only in America do people order a extra large hamburger with large fries and a DIET coke...''","worldsays, ''Only in America do banks leave both doors open at all times, and chain there pens to the counters...''","worldsays, ''Only in America do people park there cars in the driveway and put all there junk in the garage...''","worldsays, ''Why do they have braal lettering on drive through ATM machines?''","worldsays, ''Why do people sterolize lethal injection shots?''","worldsays, ''Who tests the new and improved dog food?''","worldsays, ''Why are apartments so close together?''","worldsays, ''Why is rush hour called rush hour if it goes so slow?''","worldsays, ''Why is abreviation such a long word?''","worldsays, ''Ever heard the phrase, ''Practice makes perfect?''  Well if no one is perfect, why practice?''","worldsays, ''She had more hair than a cat coughs up in a life time, and she almost lost it all because of her Eating Disorder.  ''It was terrible, I would normally eat 2 to 3 Kwowa Bears a day.''''","worldsays, ''Isn't it strange how the professor on Giligan's Island could make a Cocnut Radio and a Robot, but couldn't make a small raft to get em' off the damned island?''","worldsays, ''One day I walked into a small store and saw a man sitting there with a box.  I asked the man what was inside and he immediately opened it.  I suddenly heard a nice tune and looked down to see a man playing the piano inside the box.  When I asked the man where he got the cool box, he directed me to a Wizard in the corner.  I walked over to the wizard and asked for a million bucks.  Suddenly a million ducks filled the streets. Stumbled, I walked back to the man with a box and told him what had happened.  He gave me a odd look and said, ''Do you think I asked for a Eight Inch Pianist ?''''","worldsays, ''Hey I got a question.  Why did the chicken cross the road?  Because the one on the other side crossed it.''","worldsays, ''If money grew on trees, people say the economy would collapse...Autumn's only one month for Christ's sake!''","worldsays, ''Fuzzy wuzzy was a Bear. Fuzzy wuzzy had no hair.  Fuzzy wuzzy wasn't fuzzy wuzzy now was he?''","worldsays, ''When we no longer rely on machines hell will freeze over, mind you it does that every time I use the toaster too.''","worldsays, ''A man walks into a bar and orders a drink. The barkeeper brings him a drink and the man throws it against the wall screaming, ''I ORDERED A DRINK!'' ''But that is a drink.'' replied the barkeeper shocked. ''It is not when I was talking to Bob earlier he told me a drink always means a fun night!'' says the man.''","worldsays, ''Remember, if you complete the third quest you will be unable to re-enter any dungeon and train and in extreme case Metroid has been known to drive a burning hot poker through peoples skulls for this heinous crime.''","worldsays, ''Windows XP2 is said to be under delays following problems over it being a piece of shit.  However, it should be back on track to being an effective Operating System for 2004...By the Year 2031...''")
var/dollbumps = list("Ouch! Bitch, leave me the **** alone!  I'm not one to be ****ed with!","What the **** man?  I thought we were pals.  Well now, **** you!","If you EVER hit me again, I will release a can of WHOOP ASS on you!","Don't ****ing touch me!  I'll **** your ass up!","Temper man, wait your turn!","Never mess with me again, I'll eat you alive!","Try that again, and your ****ing head will end up your ****ing ass!","Hey, what's up?","Don't mess with me!","Yo, how's it going in the house?","Let's ****.","You asked for it!  Let's get it on!","Try it, I dare you, you stupid piece of ****ing shit!")
var/killmsg = list("Wooh!","^_^","Bring 'em ON!","Yay!","We are doing good, Master!","Yeah!","Tada!  Told ya I'm good for something...","See, It's good to keep me around!","Go Go Go!","Another one bites the dust!","That should teach him!","Damn, I'm good!","Muhahahahahahahaha!","I'm almost as good as you, Master!","Woot!  Woot!  Woot!","Victory is ours!")
var/mutedmsgs = list("I'm gay.","I'm a fat stupid fuck.","Fuck me.","I'm gay and I keep talking because I'm muted.","Hey guess what!  I have no life!","Im gay, just like my character.","Did you know?  Being muted means I make fun of myself.","Hey, I like making fun of myself!","Let's make fun of ourselves...ALL DAY LONG!","I'm one stupid fuck, huh?","I'm one retarded fuck, ain't I?","I wonder if there's anyone as dumb as me?","I have no life, Wooh!","Being muted is fun.  It's so fun, that my messages are turned into this nonsense.","It's fun to keep talking, even though I'm muted.","I have no life, what's new?","I'm so stupid, that I'm still talking, even though I'm muted!","Long live the idiot who keeps talking while muted!","Long live the Stupid Fucks!")

var/global/list/maxchars=list()
var/global/housingon = 1

proc/met_step_rand(atom/movable/a)
	step(a,pick(NORTH,SOUTH,WEST,EAST))

//mob/New()
//	..()
//	timechange()

/*mob
	proc
		timechange()
			sleep(10)
			src.timesec += 1
			if(src.timesec == 60)
				src.timesec = 0
				src.timemin += 1
			if(src.timemin == 60)
				src.timemin = 0
				src.timehour += 1
			src.timeshow = "[src.timehour]:[src.timemin]:[src.timesec]"
			spawn(0)
				timechange()*/

client
	var/moving=0
	Move()
		if(!moving)
			moving=1
			.=..()
			sleep(2)
			moving=0
		else
			return 0

proc
	RandomMob()
		sleep(600)
		var/list/mobs = new
		for(var/mob/M in world)
			mobs += M
		var/randommob = pick(mobs)
		var/randommsg = pick(sayings)
		for(var/mob/Newchar/A in world)
			if(A.npcsay == 1)
				A << "\icon[randommob] <font color=white><b>[randommob] (NPC) [randommsg]</font>"
		spawn(2400)
			RandomMob()

proc
	AutoSaveObjs()
		sleep(6000)
		SaveObjects()
		spawn(1)
			AutoSaveObjs()

proc
	AutoSave()
		sleep(600)
		for(var/mob/Newchar/m in world)
			if(m && m.client)
				m.client.base_SaveMob()
		world << "Players saved."
		spawn(600)
			AutoSave()

client/New()
	..()
	global.players+=src
	if(global.maxchars != src)
		global.maxchars+=src

world/New()
//	if(global.housingon == 0)
//		LoadHouses()
//		LoadObjects()
	Repopcall()
	AutoSave()
	RandomMob()
	AutoSaveObjs()
	AutoReboot()
	for(var/index=1,index<=(51),index++)
		houses+=num2text(index)
		houses[num2text(index)]=list()
		for(var/obj/house_tag/O in world)
			if(O.name==num2text(index))
				houses[num2text(index)]+=O

proc
	Repopcall()
		spawn
		while(1)
			sleep(300)
			for(var/obj in world)
			for(var/mob/M in world)
				sleep(300)
				world.Repop()

world/Del()
	//if(global.housingon == 0)
//	SaveHouses()
//	SaveObjects()
	..()

proc
	AutoReboot()
		spawn(264000)
			world << "<font color = teal><font size = 4><b>The world will reboot in 10 minutes!</font>"
			sleep(3000)
			world << "<font color = teal><font size = 4><b>The world will reboot in 5 minutes!</font>"
			sleep(2400)
			world << "<font color = teal><font size = 4><b>The world will reboot in 1 minute!</font>"
			sleep(600)
			world << "<font color = teal><font size = 4><b>The world is rebooting!</font>"
			world.Reboot()

world/loop_checks=0

mob/Login()
	world.log="Runtime.txt"

client
	script = "<STYLE>BODY {background: black; color: #66CC66}</STYLE>"
	base_num_characters_allowed = 5

world
	mob = /mob/Newchar/creating_character
	view = 8
	name = "SJ2"
	status = "Version 1.8"
	hub = "Polantaris.SlimeJourneyIITheRetrieversGuild"
	hub_password = "Jablablaris"

mob/New()
	..()
	spawn(1)
		if(!client)key=null

mob/proc
	CheckSkills()
		if(!src.spell.Find("-=Cancel=-"))
			src.spell += "-=Cancel=-"
		if(!src.spell.Find("Bash")&&src.bash)
			src.spell += "Bash"
		if(!src.spell.Find("Super Bash")&&src.superbash)
			src.spell += "Super Bash"
		if(!src.spell.Find("Multi Swing")&&src.multiswing)
			src.spell += "Multi Swing"
		if(!src.spell.Find("Mega Multi Swing")&&src.megamultiswing)
			src.spell += "Mega Multi Swing"
		if(!src.spell.Find("Enflamed Attack")&&src.enflameattack)
			src.spell += "Enflamed Attack"
		if(!src.spell.Find("Super Enflamed Attack")&&src.superenflameattack)
			src.spell += "Super Enflamed Attack"
		if(!src.spell.Find("Iced Attack")&&src.iceattack)
			src.spell += "Iced Attack"
		if(!src.spell.Find("Super Iced Attack")&&src.supericeattack)
			src.spell += "Super Iced Attack"
		if(!src.spell.Find("Tornado Attack")&&src.tornattack)
			src.spell += "Tornado Attack"
		if(!src.spell.Find("Super Tornado Attack")&&src.supertornattack)
			src.spell += "Super Tornado Attack"
		if(!src.spell.Find("Consentrated Attack")&&src.consenattack)
			src.spell += "Consentrated Attack"
		if(!src.spell.Find("Super Consentrated Attack")&&src.superconsenattack)
			src.spell += "Super Consentrated Attack"
		if(!src.spell.Find("Heal")&&src.priestheal)
			src.spell += "Heal"
		if(!src.spell.Find("Super Heal")&&src.superheal)
			src.spell += "Super Heal"
		if(!src.spell.Find("Holy Bolt")&&src.holybolt)
			src.spell += "Holy Bolt"
		if(!src.spell.Find("Holy Lightning")&&src.holylit)
			src.spell += "Holy Lightning"
		if(!src.spell.Find("Holy Cross")&&src.holycross)
			src.spell += "Holy Cross"
		if(!src.spell.Find("Holy Hammer")&&src.holyham)
			src.spell += "Holy Hammer"
		if(!src.spell.Find("Holy Hammers")&&src.holyhams)
			src.spell += "Holy Hammers"
		if(!src.spell.Find("Beat")&&src.beat)
			src.spell += "Beat"
		if(!src.spell.Find("Cosmic Blast")&&src.cblast)
			src.spell += "Cosmic Blast"
		if(!src.spell.Find("Master's Cosmic Blast")&&src.masterscblast)
			src.spell += "Master's Cosmic Blast"
		if(!src.spell.Find("Fire Burst")&&src.fireburst)
			src.spell += "Fire Burst"
		if(!src.spell.Find("Super Fire Burst")&&src.superfireburst)
			src.spell += "Super Fire Burst"
		if(!src.spell.Find("Ice Burst")&&src.iceburst)
			src.spell += "Ice Burst"
		if(!src.spell.Find("Super Ice Burst")&&src.supericeburst)
			src.spell += "Super Ice Burst"
		if(!src.spell.Find("Wind Burst")&&src.windburst)
			src.spell += "Wind Burst"
		if(!src.spell.Find("Super Wind Burst")&&src.superwindburst)
			src.spell += "Super Wind Burst"
		if(!src.spell.Find("Lightning Burst")&&src.lightningburst)
			src.spell += "Lightning Burst"
		if(!src.spell.Find("Super Lightning Burst")&&src.superlightningburst)
			src.spell += "Super Lightning Burst"
		if(!src.spell.Find("Earth Burst")&&src.earthburst)
			src.spell += "Earth Burst"
		if(!src.spell.Find("Super Earth Burst")&&src.superearthburst)
			src.spell += "Super Earth Burst"
		if(!src.spell.Find("Speed Strike")&&src.speedstrike)
			src.spell += "Speed Strike"
		if(!src.spell.Find("Assassinate")&&src.assassinate)
			src.spell += "Assassinate"
		if(!src.spell.Find("Glare")&&src.glare)
			src.spell += "Glare"
		if(!src.spell.Find("MP Drain")&&src.mpd)
			src.spell += "MP Drain"
		if(!src.spell.Find("Poison Bottle")&&src.pois)
			src.spell += "Poison Bottle"
		if(!src.spell.Find("Silent Death")&&src.sd)
			src.spell += "Silent Death"
		if(!src.spell.Find("Masterful Death")&&src.msd)
			src.spell += "Masterful Death"

	CheckMusic()
		if(src.whereat == "Town")
			usr << sound('town.mid',1,0,0)
		if(src.whereat == "Outside")
			usr << sound('outside.mid',1,0,0)
		if(src.whereat == "Dungeon 1")
			usr << sound('dungeon1.mid',1,0,0)
		if(src.whereat == "Dungeon 2")
			usr << sound('dungeon2.mid',1,0,0)
		if(src.whereat == "Dungeon 3")
			usr << sound('dungeon3.mid',1,0,0)
		if(src.whereat == "Dungeon 4")
			usr << sound('dungeon4.mid',1,0,0)
		if(src.whereat == "Tunnel")
			usr << sound('tunnel.mid',1,0,0)
		if(src.whereat == "Battle")
			usr << sound('battle.mid',1,0,0)
		if(src.whereat == "Boss")
			usr << sound('boss.mid',1,0,0)


mob
	Login()
		..()
		src.pvping = null
		CheckBan(src)
		var/ips = file("ip.txt")
		var/ips2 = file("keysip.txt")
		ips << "[src.key]'s IP is [src.client.address]!"
		ips2 << src.key
		if(src.key == "Communist Marx")
			del(src)
			return
		src << "<font size = 3>There's a new site and boards for SJ!  The site may be down, I, Polantaris, do not know.  But, the permanant fourms is NOW: http://www.phpbbserver.com/phpbb/sjge.html.  Join as soon as you can, and talk away, anything you want to know, need help with, etc, should be posted, I will be glad to help."
		if(src.key == "Metroid")
			src.Owner_Commands()
		if(src.key == "Polantaris")
			src.Owner_Commands()
		if(src.key == "Alcatraz001")
			src.Owner_Commands()
		if(src.key == "Ball")
			src.GM_Commands()
		if(src.Admin == 1)
			src << "Information for GMs:  Please, do not ask for additional commands, or new ones.  It will result in a No, or if suggested several times, a removal of GM."
		world << "\icon[usr] <font color = teal><b>[html_encode(src.name)]([src.key]) logs in."
		src.loc = locate(src.savex, src.savey, src.savez)
		src.sight = 2
		src << "Welcome to Slime Journey II: The Retriever's Guild!  Any questions and comments should be reported to the boards IMMEDIATLY!"
		src << ""
		src << "<font color = red><b><u>Please, all new players, check out the forums at http://www.electroforums.net!  Enjoy the game and have fun!  <font color = red><b> IF YOU DON'T READ THE RULES, DON'T COMPLAIN WHEN YOU ARE BANNED FOR BREAKING THEM!  I DON'T WANT TO HEAR YOUR SHIT!</font>"
		src << ""
		src << "Currently, this is the Public Testing Phase.  We have 4 Jobs plus Advanced Jobs for the 4 Jobs, 5 Clans, 39 Skills ( No Advanced Job skills yet )= ), 127 Monster Skills, 52 Monsters, 6 Unique Monsters, 5 Bosses, 4 Quests, 6 Dungeons, 12 Transformations, 41 Job Levels, 1020 Normal Levels,  24 House Items, 58 Dolls,  47 Houses, A Nice Title Screen, and 10 Summons. =P Enjoy."
		src << ""
		src << "Added a hopefully working system where you cannot beat Bosses more than once, you beat them, GO ON WITH THE GAME!  No more training on Boss Monsters...I hope."
		src << ""
		src << "Housing system is still down...I'm working on it, but this saving problem is first."
		src << ""
		var/ab
		for(var/mob/monster/M in world)
			ab += 1
		src << "There are [ab] monsters in the world at this time."
		src << ""
		src << "This version is [version]. [versionmsg]"
		src.icon = 'slimes.dmi'
		if(src.loggedin == 0)
			var/a = alert("This is the first time you have logged on!  Do you wish to go to the Newbie Zone?","Newb Zone","Yes","No")
			if(a == "Yes")
				src.loggedin = 1
				src.loc = locate(14,149,1)
			if(a == "No")
				src.loggedin = 1
				src.loc = locate(35,26,1)
		for(var/area/housing/B in world)
			if(B.owner == src.key)
				src.ownerhouse = 1
			if(B.needtochange == src)
				B.needtochange = null
				src.urhousex = 0
				src.urhousey = 0
				src.urhousez = 0
				src.ownerhouse = 0
		if(src.monsterinparty)
			if(src.monsterinparty.x != 0)src.monsterinparty.x = 0
		if(src.guild != null)
			src.verbs+=typesof(/mob/guild/verb)
		if(src.guildleader == src.key)
			src.verbs+=typesof(/mob/guildleader/verb)
		if(src.monsterfollow != null)
			//var/mob/m = new src.monsterfollow.type(usr.x-1,usr.y,usr.z)
			new src.monsterfollow.type(src.x,src.y,src.z)
			AddVerbSummons()
			//src.monsterfollow = m
		if(src.cannottalk == 1)
			src.cannottalk = 0
		src.monstersinbattle = 0
		src.inbattle = 0
		if(src.islocked == 1)
			src.islocked = 0
		if(src.battle == 1)
			src.battle = 0
		if(src.lib == 1)
			src << "<font size = 3><font color = red><b>Please refrain from logging out in battle."
			world << "<font color = red><b>[html_encode(usr)] had logged out of battle the last time he was on."
			src.lib = 0
			src.battle = 0
		if(src.libs == 1)
			world << "<font size = 4><font color = red><b>[src] has logged out during PVP!  He loses 1/30th of his EXP as a note to not log out during PVP!"
			var/exploss = src.exp / 30
			src.exp -= exploss
			src.exp = round(src.exp)
			src.libs = 0
			src.battle = 0
		src.whereat = src.area
		CheckSkills()
		CheckMusic()
		if(src.level == "Cow")
			src.level = 1
		if(src.chosemonnum == 0)
			src.verbs += /mob/Special/verb/Monster_Number_Chooser
		alert("We are having a terrible save file corruption problem going on.  If your character has been deleted, that is because of this problem.  Please, do not complain, leave if you must, or just start over.  Any complaints mean you want to be muted.  This stuff happens when you are playing a game in the Alpha stage.")

var
	version = "Public Version 1.8"
	versionmsg = "Welcome to Version 1.8 of Slime Journey 2!  Please, report all bugs and enjoy the game.  Remember to keep up to date with the new updates by checking out the site and fourm!  This game is Protected by Metroid's Spam Killer.  Version 1.8 adds Summon Merging.  You can merge with your summon to make your stats much higher!  It will be very useful later on in the game.  Also, a New Stat Tab system.  Click on the bars to see your stats now.  Any bugs with it should be reported.  The Zenithian Temple, at the end of the Tunnel to Town 2 is finished.  Enjoy it, when its FULLY finished, there will be new skills to learn!"

client
	Northeast()
	Northwest()
	Southeast()
	Southwest()

mob
	Logout()
		if(!usr || !src)
			del(src)
			return
		if(src.battle)
			world << "<font color = red><b>[html_encode(src)] has logged out during battle!"
			src.battle = 0
			src.islocked = 0
			if(src.defend)
				src.defend = 0
				src.defense /= 2
		if(src.monsterfollow != null)
			del(src.monsterfollow)
		if(src.libs == 1)
			for(var/mob/Newchar/M in world)
				if(!M)
					return
				if(M.pvping == src)
					world << "Due to log out during PVP by [src], [M] is rewarded the winner!"
					M.islocked = 0
					M.libs = 0
					var/goldgained = src.gold/2
					M.gold += goldgained
					M.gold = round(M.gold)
					src.gold -= goldgained
					src.gold = round(src.gold)
					M.pvping = null
					src.pvping = null
					src.pvpsummon = 1
					src.pvpplayer = 1
					M.pvpsummon = 1
					M.pvpplayer = 1
	//	world.log << "[src.name] disconnected from the game from [src.client.address]!"
		world << "<font color = teal><b>[html_encode(src.name)] logs out."
		del(src)

client/Del()
	mob.pvping = null
	..()

var/global/list/players=list()

client/Del()
	..()
	global.players-=src